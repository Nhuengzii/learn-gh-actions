openapi: "3.0.1"
info:
  title: "LearnHUB API"
  description: "This is an API for LearnHUB system."
  version: "1.0.0"
  contact:
    email: "learnhubdev@gmail.com"
servers:
  # id is subject to change
  - url: "https://{domain}/{stage}"
    variables:
      id:
        default: "test_domain"
      stage:
        default: "dev"
tags:
  - name: user
    description: "Operations that involve users"
  - name: achievement
    description: "Operations that involve achievements"
  - name: program
    description: "Operations that involve study programs"
  - name: transaction
    description: "Operations that involve transaction"
  - name: auth
    description: "Operations that involve user's authentication"
paths:
  /users/students:
    get:
      tags:
        - user
      summary: List all students basic information.
      description: |
        For retrieving multiple students's profile.
      operationId: listStudents
      responses:
        "200":
          description: "OK: List students."
          content:
            application/json:
              schema:
                required:
                  - students
                properties:
                  students:
                    type: array
                    items:
                      $ref: "#/components/schemas/student"
  "/users/students/{student-id}":
    get:
      tags:
        - user
      summary: Get specific student's basic information.
      description: |
        For retrieving a student's profile.
      operationId: getStudent
      parameters:
        - $ref: "#/components/parameters/studentID"
      responses:
        "200":
          description: "OK: Get student."
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/student"
    patch:
      tags:
        - user
      summary: Edit specific student's basic information.
      description: |
        For editing a student's profile.
      operationId: patchStudent
      parameters:
        - $ref: "#/components/parameters/studentID"
      requestBody:
        description: Student profile edit
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                username:
                  type: string
                  example: "paff"
                fullname:
                  type: string
                  example: "foo bar"
                profile_pic:
                  type: string
                  example: "https://example-pic.png"

      responses:
        "200":
          $ref: "#/components/responses/OK"
    delete:
      tags:
        - user
      summary: Delete specific student's account.
      description: |
        For removing a student's account.
      operationId: deleteStudent
      parameters:
        - $ref: "#/components/parameters/studentID"
      responses:
        "200":
          $ref: "#/components/responses/OK"
  "/users/students/{student-id}/achievements":
    get:
      tags:
        - user
      summary: List student's achievements.
      description: For retrieving specific student's achievements.
      operationId: listStudentAchievements
      parameters:
        - $ref: "#/components/parameters/studentID"
      responses:
        "200":
          description: "OK: List student's achievements."
          content:
            application/json:
              schema:
                required:
                  - achievements
                properties:
                  achievements:
                    type: array
                    items:
                      $ref: "#/components/schemas/studentAchievement"
  "/users/students/{student-id}/programs":
    get:
      tags:
        - user
      summary: List student's programs.
      description: For retrieving specific student's programs.
      operationId: listStudentPrograms
      parameters:
        - $ref: "#/components/parameters/studentID"
      responses:
        "200":
          description: "OK: List student's programs."
          content:
            application/json:
              schema:
                required:
                  - courses
                  - classes
                properties:
                  courses:
                    type: array
                    items:
                      $ref: "#/components/schemas/userCourse"
                  classes:
                    type: array
                    items:
                      $ref: "#/components/schemas/userClass"
  "/users/students/{student-id}/programs/classes":
    get:
      tags:
        - user
      summary: List student's classes.
      description: For retrieving specific student's classes.
      operationId: listStudentClasses
      parameters:
        - $ref: "#/components/parameters/studentID"
      responses:
        "200":
          description: "OK: List student's classes."
          content:
            application/json:
              schema:
                required:
                  - classes
                properties:
                  classes:
                    type: array
                    items:
                      $ref: "#/components/schemas/userClass"
  "/users/students/{student-id}/programs/courses":
    get:
      tags:
        - user
      summary: List student's courses.
      description: |
        For retrieving specific student's courses.
      operationId: listStudentCourses
      parameters:
        - $ref: "#/components/parameters/studentID"
      responses:
        "200":
          description: "OK: List student's courses."
          content:
            application/json:
              schema:
                required:
                  - courses
                properties:
                  courses:
                    type: array
                    items:
                      $ref: "#/components/schemas/userCourse"
  "/users/students/{student-id}/wishlist":
    get:
      tags:
        - user
      summary: List student's wishlist items.
      description: |
        For retrieving specific student's wishlist items.
      parameters:
        - $ref: "#/components/parameters/studentID"
      operationId: listStudentWishlist
      responses:
        "200":
          description: "OK: List student's wishlist"
          content:
            application/json:
              schema:
                required:
                  - wishlist
                properties:
                  wishlist:
                    type: array
                    items:
                      $ref: "#/components/schemas/studentWishlistItem"
    post:
      tags:
        - user
      summary: Add a student's wishlist item.
      description: |
        For adding specific student's wishlist item.
      parameters:
        - $ref: "#/components/parameters/studentID"
      operationId: postStudentWishlist
      requestBody:
        description: Class or Course to add to wishlist.
        required: true
        content:
          application/json:
            schema:
              minItems: 2
              maxItems: 2
              required:
                - type
              properties:
                type:
                  type: string
                  example: "class"
                class_id:
                  type: string
                  example: "1234"
                course_id:
                  type: string
                  example: "1234"
      responses:
        "200":
          description: "OK: Add student's wishlist item"
          content:
            application/json:
              schema:
                required:
                  - wishlist-item-id
                properties:
                  wishlist-item-id:
                    type: string
                    example: "1234"
  "/users/students/{student-id}/wishlist/{wishlist-item-id}":
    get:
      tags:
        - user
      summary: Get student's specific wishlist item.
      description: |
        For retrieving a student's wishlist item.
      parameters:
        - $ref: "#/components/parameters/studentID"
        - $ref: "#/components/parameters/wishlistItemID"
      operationId: getStudentWishlistItem
      responses:
        "200":
          description: "OK: Get a student's wishlist item"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/studentWishlistItem"
    delete:
      tags:
        - user
      summary: Delete student's specific wishlist item.
      description: |
        For removing student's wishlist item.
      parameters:
        - $ref: "#/components/parameters/studentID"
        - $ref: "#/components/parameters/wishlistItemID"
      operationId: deleteStudentWishlistItem
      responses:
        "200":
          $ref: "#/components/responses/OK"
  "/users/students/{student-id}/config":
    get:
      tags:
        - user
      summary: Get student's config.
      description: |
        For retrieving a student's config.
      parameters:
        - $ref: "#/components/parameters/studentID"
      operationId: getStudentConfig
      responses:
        "200":
          description: "OK: Get a student's config"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/userConfig"
    patch:
      tags:
        - user
      summary: Patch student's config.
      description: |
        For editing a student's config.
      parameters:
        - $ref: "#/components/parameters/studentID"
      operationId: patchStudentConfig
      requestBody:
        description: student config edit
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/userConfig"
      responses:
        "200":
          $ref: "#/components/responses/OK"
  "/users/students/{student-id}/payment-methods":
    get:
      tags:
        - user
      summary: List student's payment methods.
      description: |
        For retrieving a student's payment methods.
      parameters:
        - $ref: "#/components/parameters/studentID"
      operationId: listStudentPaymentMethods
      responses:
        "200":
          description: "OK: List student's payment methods"
          content:
            application/json:
              schema:
                properties:
                  payment_methods:
                    type: array
                    items:
                      $ref: "#/components/schemas/userPaymentMethod"
    post:
      tags:
        - user
      summary: Add  a student's payment method.
      description: |
        For adding a student's payment method.
      parameters:
        - $ref: "#/components/parameters/studentID"
      operationId: postStudentPaymentMethod
      requestBody:
        description: User's payment method details
        required: true
        content:
          application/json:
            schema:
              required:
                - name
                - type
                - card_number
                - cvc
                - expiration_date
                - holder_fullname
              properties:
                name:
                  type: string
                  example: "my-kbank-debit"
                type:
                  type: string
                  example: "kbank_debit"
                card_number:
                  type: integer
                  example: 12121313
                cvc:
                  type: integer
                  example: 232
                expiration_date:
                  type: string
                  example: "08/25"
                holder_fullname:
                  type: string
                  example: "foo bar"
      responses:
        "200":
          description: "OK: Add student's payment methods"
          content:
            application/json:
              schema:
                properties:
                  payment_method_id:
                    type: string
                    example: "1234"
  "/users/students/{student-id}/payment-methods/{payment-method-id}":
    get:
      tags:
        - user
      summary: Get student's payment method.
      description: |
        For retrieving a student's payment method.
      parameters:
        - $ref: "#/components/parameters/studentID"
        - $ref: "#/components/parameters/paymentMethodID"
      operationId: getStudentPaymentMethod
      responses:
        "200":
          description: "OK: Get student's specific payment method"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/userPaymentMethod"
    patch:
      tags:
        - user
      summary: Edit student's payment method.
      description: |
        For editing a student's payment method.
      parameters:
        - $ref: "#/components/parameters/studentID"
        - $ref: "#/components/parameters/paymentMethodID"
      operationId: patchStudentPaymentMethod
      requestBody:
        description: User's payment method details to edit
        required: true
        content:
          application/json:
            schema:
              required:
                - name
                - type
                - card_number
                - cvc
                - expiration_date
                - holder_fullname
              properties:
                name:
                  type: string
                  example: "my-kbank-debit"
                type:
                  type: string
                  example: "kbank_debit"
                card_number:
                  type: integer
                  example: 12121313
                cvc:
                  type: integer
                  example: 232
                expiration_date:
                  type: string
                  example: "08/25"
                holder_fullname:
                  type: string
                  example: "foo bar"
      responses:
        "200":
          $ref: "#/components/responses/OK"
    delete:
      tags:
        - user
      summary: Delete student's payment method.
      description: |
        For deleting a student's payment method.
      parameters:
        - $ref: "#/components/parameters/studentID"
        - $ref: "#/components/parameters/paymentMethodID"
      operationId: deleteStudentPaymentMethod
      responses:
        "200":
          $ref: "#/components/responses/OK"
  "/users/students/{student-id}/purchases-history":
    get:
      tags:
        - user
      summary: Get student's purchases-history
      description: |
        For retrieving student's purchases-history
      parameters:
        - $ref: "#/components/parameters/studentID"
      operationId: getStudentPurchasesHistory
      responses:
        "200":
          description: "OK: Get student's purchases history"
          content:
            application/json:
              schema:
                properties:
                  purchases_history:
                    type: array
                    items:
                      $ref: "#/components/schemas/studentPurchasesHistoryItem"
  "/users/student/{student-id}/basket":
    get:
      tags:
        - user
      summary: Get student's basket
      description: |
        For retrieving student's basket
      parameters:
        - $ref: "#/components/parameters/studentID"
      operationId: getStudentBasket
      responses:
        "200":
          description: "OK: Get student's basket"
          content:
            application/json:
              schema:
                properties:
                  basket:
                    type: array
                    items:
                      $ref: "#/components/schemas/studentBasketItem"
    post:
      tags:
        - user
      summary: Add student's basket item
      description: |
        For adding a student's basket item
      parameters:
        - $ref: "#/components/parameters/studentID"
      operationId: addStudentBasketItem
      requestBody:
        description: Student's basket item details
        required: true
        content:
          application/json:
            schema:
              minItems: 2
              maxItems: 2
              required:
                - type
              properties:
                type:
                  type: string
                  example: "class"
                class_id:
                  type: string
                  example: "1234"
                course_id:
                  type: string
                  example: "1234"
      responses:
        "200":
          description: "OK: Add student basket item"
          content:
            application/json:
              schema:
                properties:
                  basket_item_id:
                    type: string
                    example: "1234"
  "/users/student/{student-id}/basket/{basket-item-id}":
    get:
      tags:
        - user
      summary: Get student's basket item
      description: |
        For retrieving student's basket item
      parameters:
        - $ref: "#/components/parameters/studentID"
        - $ref: "#/components/parameters/basketItemID"
      operationId: getStudentBasketItem
      responses:
        "200":
          description: "OK: Get student's basket item"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/studentBasketItem"
    delete:
      tags:
        - user
      summary: Delete student's basket item
      description: |
        For deleting student's basket item
      parameters:
        - $ref: "#/components/parameters/studentID"
        - $ref: "#/components/parameters/basketItemID"
      operationId: deleteStudentBasketItem
      responses:
        "200":
          $ref: "#/components/responses/OK"
  /users/teachers:
    get:
      tags:
        - user
      summary: List all teachers basic information.
      description: |
        For retrieving multiple teacher's profile.
      operationId: listTeachers
      responses:
        "200":
          description: "OK: List teachers."
          content:
            application/json:
              schema:
                required:
                  - teachers
                properties:
                  teachers:
                    type: array
                    items:
                      $ref: "#/components/schemas/teacher"
  "/users/teachers/{teacher-id}/programs":
    get:
      tags:
        - user
      summary: List teacher's programs.
      description: For retrieving specific teacher's programs.
      operationId: listTeacherPrograms
      parameters:
        - $ref: "#/components/parameters/teacherID"
      responses:
        "200":
          description: "OK: List teacher's programs."
          content:
            application/json:
              schema:
                required:
                  - courses
                  - classes
                properties:
                  courses:
                    type: array
                    items:
                      $ref: "#/components/schemas/userCourse"
                  classes:
                    type: array
                    items:
                      $ref: "#/components/schemas/userClass"
  "/users/teachers/{teacher-id}/programs/classes":
    get:
      tags:
        - user
      summary: List teacher's classes.
      description: For retrieving specific teacher's classes.
      operationId: listTeacherClasses
      parameters:
        - $ref: "#/components/parameters/teacherID"
      responses:
        "200":
          description: "OK: List teacher's classes."
          content:
            application/json:
              schema:
                required:
                  - classes
                properties:
                  classes:
                    type: array
                    items:
                      $ref: "#/components/schemas/userClass"
  "/users/teachers/{teacher-id}/programs/courses":
    get:
      tags:
        - user
      summary: List teacher's courses.
      description: |
        For retrieving specific teacher's courses.
      operationId: listTeacherCourses
      parameters:
        - $ref: "#/components/parameters/teacherID"
      responses:
        "200":
          description: "OK: List teacher's courses."
          content:
            application/json:
              schema:
                required:
                  - courses
                properties:
                  courses:
                    type: array
                    items:
                      $ref: "#/components/schemas/userCourse"
  "/users/teachers/{teacher-id}/config":
    get:
      tags:
        - user
      summary: Get teacher's config.
      description: |
        For retrieving a teacher's config.
      parameters:
        - $ref: "#/components/parameters/teacherID"
      operationId: getTeacherConfig
      responses:
        "200":
          description: "OK: Get a teacher's config"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/userConfig"
    patch:
      tags:
        - user
      summary: Patch teacher's config.
      description: |
        For editing a teacher's config.
      parameters:
        - $ref: "#/components/parameters/teacherID"
      operationId: patchTeacherConfig
      requestBody:
        description: teacher config edit
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/userConfig"
      responses:
        "200":
          $ref: "#/components/responses/OK"
  "/users/teachers/{teacher-id}/payment-methods":
    get:
      tags:
        - user
      summary: List teacher's payment methods.
      description: |
        For retrieving a teacher's payment methods.
      parameters:
        - $ref: "#/components/parameters/teacherID"
      operationId: listTeacherPaymentMethods
      responses:
        "200":
          description: "OK: List teacher's payment methods"
          content:
            application/json:
              schema:
                properties:
                  payment_methods:
                    type: array
                    items:
                      $ref: "#/components/schemas/userPaymentMethod"
    post:
      tags:
        - user
      summary: Add  a teacher's payment method.
      description: |
        For adding a teacher's payment method.
      parameters:
        - $ref: "#/components/parameters/teacherID"
      operationId: postTeacherPaymentMethod
      requestBody:
        description: User's payment method details
        required: true
        content:
          application/json:
            schema:
              required:
                - name
                - type
                - card_number
                - cvc
                - expiration_date
                - holder_fullname
              properties:
                name:
                  type: string
                  example: "my-kbank-debit"
                type:
                  type: string
                  example: "kbank_debit"
                card_number:
                  type: integer
                  example: 12121313
                cvc:
                  type: integer
                  example: 232
                expiration_date:
                  type: string
                  example: "08/25"
                holder_fullname:
                  type: string
                  example: "foo bar"
      responses:
        "200":
          description: "OK: Add teacher's payment methods"
          content:
            application/json:
              schema:
                properties:
                  payment_method_id:
                    type: string
                    example: "1234"
  "/users/teachers/{teacher-id}/payment-methods/{payment-method-id}":
    get:
      tags:
        - user
      summary: Get teacher's payment method.
      description: |
        For retrieving a teacher's payment method.
      parameters:
        - $ref: "#/components/parameters/teacherID"
        - $ref: "#/components/parameters/paymentMethodID"
      operationId: getTeacherPaymentMethod
      responses:
        "200":
          description: "OK: Get teacher's specific payment method"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/userPaymentMethod"
    patch:
      tags:
        - user
      summary: Edit teacher's payment method.
      description: |
        For editing a teacher's payment method.
      parameters:
        - $ref: "#/components/parameters/teacherID"
        - $ref: "#/components/parameters/paymentMethodID"
      operationId: patchTeacherPaymentMethod
      requestBody:
        description: User's payment method details to edit
        required: true
        content:
          application/json:
            schema:
              required:
                - name
                - type
                - card_number
                - cvc
                - expiration_date
                - holder_fullname
              properties:
                name:
                  type: string
                  example: "my-kbank-debit"
                type:
                  type: string
                  example: "kbank_debit"
                card_number:
                  type: integer
                  example: 12121313
                cvc:
                  type: integer
                  example: 232
                expiration_date:
                  type: string
                  example: "08/25"
                holder_fullname:
                  type: string
                  example: "foo bar"
      responses:
        "200":
          $ref: "#/components/responses/OK"
    delete:
      tags:
        - user
      summary: Delete teacher's payment method.
      description: |
        For deleting a teacher's payment method.
      parameters:
        - $ref: "#/components/parameters/teacherID"
        - $ref: "#/components/parameters/paymentMethodID"
      operationId: deleteTeacherPaymentMethod
      responses:
        "200":
          $ref: "#/components/responses/OK"

components:
  responses:
    OK:
      description: Server return 200 OK response.
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/responseScheme"
          example:
            code: 200
            message: "OK"

    InternalServerError:
      description: Server encounter unexpected errors.
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/responseScheme"
          example:
            code: 500
            message: "Internal Server Error"
    Unauthorized:
      description: Unauthorized.
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/responseScheme"
          example:
            code: 401
            message: "Unauthorized"
    NotFound:
      description: The specified resource was not found.
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/responseScheme"
          example:
            code: 404
            message: "Not Found"

  schemas:
    responseScheme:
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: number
          example: 400
        message:
          type: string
          example: "Internal Server Error"
    userCourse:
      type: object
      required:
        - course_id
        - name
      properties:
        course_id:
          type: string
          example: "1234"
        name:
          type: string
          example: "Advanced redstone weaponry"
    userClass:
      type: object
      required:
        - class_id
        - name
      properties:
        class_id:
          type: string
          example: "1234"
        name:
          type: string
          example: "Basic dropper mechanic"
    userConfig:
      type: object
      required:
        - theme
      properties:
        theme:
          type: string
          example: "light"
    userPaymentMethod:
      type: object
      required:
        - payment_method_id
        - name
        - type
        - card_number
        - cvc
        - expiration_date
        - holder_fullname
      properties:
        payment_method_id:
          type: string
          example: "1234"
        name:
          type: string
          example: "my-kbank-debit"
        type:
          type: string
          example: "kbank_debit"
        card_number:
          type: integer
          example: 12121313
        cvc:
          type: integer
          example: 232
        expiration_date:
          type: string
          example: "08/25"
        holder_fullname:
          type: string
          example: "foo bar"

    student:
      type: object
      required:
        - student_id
        - username
        - email
        - fullname
        - profile_pic
      properties:
        student_id:
          type: string
          example: "123456789"
        username:
          type: string
          example: "foo-bar"
        email:
          type: string
          example: "example@example.com"
        fullname:
          type: string
          example: "foo bar"
        profile_pic:
          type: string
          example: "https://example/pic.png"
    studentAchievement:
      type: object
      required:
        - achievement_id
        - name
        - description
        - achievement_pic
      properties:
        achievement_id:
          type: string
          example: "1234"
        name:
          type: string
          example: "Classes Collector"
        description:
          type: string
          example: "Own 10 different classes."
        achievement_pic:
          type: string
          example: "https://example/image.png"
    studentWishlistItem:
      type: object
      minItems: 4
      maxItems: 4
      required:
        - name
        - type
        - price
      properties:
        wishlist_item_id:
          type: string
          example: "1234"
        name:
          type: string
          example: "discreet math"
        type:
          type: string
          example: "class"
        class_id:
          type: string
          example: "123"
        course_id:
          type: string
          example: "123"
        price:
          type: number
          example: 1200.2
    studentPurchasesHistoryItem:
      type: object
      properties:
        type:
          type: string
          example: "class"
        class_id:
          type: string
          example: "1234"
        course_id:
          type: string
          example: "1234"
        price:
          type: number
          example: 1200
        name:
          type: string
          example: "Intro to physics"
    studentBasketItem:
      type: object
      minItems: 4
      maxItems: 4
      required:
        - name
        - type
        - price
      properties:
        basket_item_id:
          type: string
          example: "1234"
        name:
          type: string
          example: "discreet math"
        type:
          type: string
          example: "class"
        class_id:
          type: string
          example: "123"
        course_id:
          type: string
          example: "123"
        price:
          type: number
          example: 1200.2

    teacher:
      type: object
      required:
        - teacher_id
        - username
        - email
        - fullname
        - profile_pic
      properties:
        teacher_id:
          type: string
          example: "123456789"
        username:
          type: string
          example: "foo-bar"
        email:
          type: string
          example: "example@example.com"
        fullname:
          type: string
          example: "foo bar"
        profile_pic:
          type: string
          example: "https://example/pic.png"

  parameters:
    # path parameters
    studentID:
      in: path
      name: student-id
      description: uniquely identify students.
      schema:
        type: string
      example: "1234"
      required: true
    teacherID:
      in: path
      name: teacher-id
      description: uniquely identify teachers.
      schema:
        type: string
      example: "1234"
      required: true
    wishlistItemID:
      in: path
      name: wishlist-item-id
      description: uniquely identify wishlist item.
      schema:
        type: string
      example: "1234"
      required: true
    paymentMethodID:
      in: path
      name: payment-method-id
      description: uniquely identify user's payment method.
      schema:
        type: string
      example: "1234"
      required: true
    basketItemID:
      in: path
      name: basket-item-id
      description: uniquely identify student's basket item.
      schema:
        type: string
      example: "1234"
      required: true
